let CustomErrorHandler,JwtService;_b0e‍.x([["default",()=>_b0e‍.o]]);_b0e‍.w("../services/CustomErrorHandler",[["default",["CustomErrorHandler"],function(v){CustomErrorHandler=v}]]);_b0e‍.w("../services/JwtService",[["default",["JwtService"],function(v){JwtService=v}]]);


const auth=async(req,res,next)=>{
    let authHeader=req.headers.authorization;
    if(!authHeader){
        return next(CustomErrorHandler.unAuthorized())
    }
    const token =authHeader.split(' ')[1];
    try {
        const {_id,role}=await JwtService.verify(token);
        const user={
            _id,
            role
        }
        req.user=user;
        next();
        
    } catch (err) {
        return next(CustomErrorHandler.unAuthorized())
    }

}
 
_b0e‍.d(auth);